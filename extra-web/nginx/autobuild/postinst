#!/bin/bash

# Set up permission for logs
chmod 750 /var/log/nginx
chown http:log /var/log/nginx

# Place default welcome page to the destination
if [ ! -e /srv/www/index.nginx.html ]; then
	cp /usr/share/nginx/html/index.html /srv/www/index.nginx.html
fi

# Enable default site
if [ ! -e /etc/nginx/sites-enabled ]; then
	mkdir -p /etc/nginx/sites-enabled
fi

if [ ! -e /etc/nginx/sites-enabled/default ]; then
	ln -sv /etc/nginx/sites-available/default /etc/nginx/sites-enabled/default
fi

# Fix up the permissions
mkdir -p /srv/www
chmod 0644 /srv/www
chmod 0644 /srv/www/index.nginx.html

# To not to touch directories inside
chown http:http /srv/www
chown http:http /srv/www/index.nginx.html
